# Проект: Виртуальный сенсор гранулометрии

## Описание проблемы

На горно-обогатительных фабриках измерение размера частиц руды (гранулометрии) критически важно для эффективности процесса флотации. Однако физические гранулометры дороги (~30 млн руб.) и требуют сложного обслуживания. Ручные лабораторные анализы проводятся редко (раз в 12 часов) и с большой задержкой (2-4 часа). Это мешает оперативно корректировать технологический процесс.

## Техническое задание: виртуальный сенсор ситовых характеристик пульпы

**Общая цель:** Разработать предиктивную модель ("виртуальный сенсор"), которая будет оценивать гранулометрию (ситовые характеристики пульпы) на выходе измельчительного передела в реальном времени, используя косвенные показания датчиков с оборудования. Модель должна заменить или дополнить редкие лабораторные замеры, предоставляя частые прогнозы.

**Конкретная цель:** Получать в реальном времени прогноз ситовых характеристик пульпы в различных точках контура измельчения вне зависимости от наличия физических гранулометров. Требуется определить долю фракции ниже порогового значения размера.

**Задачи:**
1.  Разработать предиктивную регрессионную модель для прогнозирования ситовой характеристики пульпы в определенных точках контура измельчения.
2.  Подготовить отчет о проведенных экспериментах, привести расчеты технических метрик, документацию и примеры использования модели.

**Техническая метрика:** RMSE при сопоставлении прогнозов с фактическими данными (лабораторными или приборными).

**Особенности и архитектурные требования:**
*   Показатели ситовой характеристики с высокой частотой доступны только со специализированных приборов (гранулометров), установленных лишь в нескольких точках контура.
*   **Ключевое требование:** Модель должна иметь возможность калибровки или обучения **без** применения данных гранулометров, но **с применением** данных о ситовых характеристиках из лабораторных анализов. Применение данных с гранулометров допускается **только** для оценки качества подгонки модели.

**Дополнительные требования:**
*   Язык разработки: Python.
*   Допустимо использование только open-source компонентов.
*   Предлагаемое решение должно иметь возможность реализовывать полный перечень функций в локальном окружении без доступа к сети интернет.

**Ожидаемый результат:** Рабочая предиктивная модель, отчет о моделировании с примерами использования и рассчитанными техническими метриками.

## Описание технологического процесса

Представлено два независимых и технологически идентичных участка измельчения сырья (Поток 1 и Поток 2). Столбцы с постфиксами 1 и 2 в данных соответствуют этим участкам.

**Последовательность агрегатов:**
```
-> МПСИ >-> Грохот >-->------> Г/Ц >---------------<|       |<- МШЦ <-|
```
*   **МПСИ (Мельница полусамоизмельчения):** Крупное сырье поступает на первичное измельчение.
*   **Грохот:** Разгрузка МПСИ попадает на классифицирующий грохот.
    *   *Надрешеточный продукт* (крупные частицы) возвращается на додрабливание и затем снова объединяется с крупным сырьем в питание МПСИ.
    *   *Подрешеточный продукт* (мелкие частицы) поступает на следующую стадию.
*   **Г/Ц (Гидроциклоны):** Подрешеточный продукт грохота поступает на классификацию в гидроциклоны.
    *   *Пески* (более крупные частицы) поступают на доизмельчение в МШЦ.
    *   *Слив* (мелкие частицы) является конечным продуктом рассматриваемого участка. **Именно для слива Г/Ц производится оценка гранулометрии.**
*   **МШЦ (Мельница шаровая с центральной разгрузкой):** Пески гидроциклонов доизмельчаются и затем снова попадают в питание гидроциклонов.

## Источники данных

1.  **Телеметрия АСУТП (`data.csv` или аналогичный файл):**
    *   Временные ряды с **минутной** дискретностью с двух параллельных технологических линий (Поток 1, Поток 2).
    *   Содержит показания датчиков (мощность, ток, расходы, давление, температура и др.) с различных агрегатов.
    *   Включает показания **физических гранулометров** (используются для *оценки* модели, не для обучения).
    *   Единицы измерения указаны в названиях столбцов.
    *   **Целевые переменные для валидации:** `Гранулометрия 1 %`, `Гранулометрия 2 %`.

2.  **Лабораторные анализы (`Анализы.xlsx` или аналогичный файл):**
    *   Содержит характеристики руды и результаты лабораторных измерений гранулометрии.
    *   Данные имеют **реже** (например, ежесменную) дискретность.
    *   **Разрешено и требуется использовать как основной источник фактических данных для обучения/калибровки модели.**

## Ключевые вызовы и особенности данных

*   **Транспортные задержки:** Руда движется по технологической цепочке медленно (порядок времени неизвестен, возможно, 30+ минут). Показания датчиков в разных точках в один момент времени относятся к разным порциям руды. Модель **обязательно** должна учитывать эти задержки.
*   **Качество данных телеметрии:**
    *   Нулевые значения гранулометрии (`Гранулометрия 1 %`, `Гранулометрия 2 %`) при ненулевом питании мельниц указывают на сбой датчика (эти данные не учитывать при оценке).
    *   Датчик расхода оборотной воды на Потоке 1 может быть неисправен (соответствующий столбец может отсутствовать или содержать некорректные данные).
    *   Возможны другие ошибки и выбросы в данных датчиков, требующие очистки/обработки.
*   **Бизнес-требования:** Важнее улавливать **тренд** изменения гранулометрии (рост/падение), чем достигать абсолютной точности, хотя точность, близкая к приборной/лабораторной, желательна (метрика RMSE).
*   **Переносимость:** Предпочтительны решения, использующие минимально необходимый набор данных для лучшей адаптации к другим фабрикам/линиям.

## Критерии оценки решения

1.  **Качество модели:** Точность предсказаний (RMSE) и способность улавливать тренды изменений гранулометрии. Оценка производится путем сравнения с данными лаборатории и/или гранулометров (см. Техническое задание).
2.  **Отчет:** Качество исследования данных, визуализации, обоснование выбора модели, описание экспериментов, учет режимов работы фабрики, документация модели и примеры использования.
3.  **Дорожная карта внедрения:** Описание рисков, ограничений, путей улучшения модели, интеграции с реальным производством, требований к вычислительным мощностям.
4.  **Бизнес-применимость:** Практическая ценность решения для оперативного управления производством.

## Планируемая реализация (Веб-интерфейс/Дашборд)

Предлагается создать систему мониторинга для отслеживания состояния отдельных производственных участков/линий:

*   **Общий вид:** Список отслеживаемых участков со статусом и последними прогнозами гранулометрии. Возможность настройки отображаемых участков.
*   **Страница участка:**
    *   Отображение последних N прогнозов гранулометрии.
    *   График динамики прогнозируемой гранулометрии.
    *   Индикация попадания прогноза в целевой диапазон крупности.
    *   Отображение текущего статуса участка ("Работает", "Сбой", "Остановлен" - на основе данных телеметрии).
    *   Логи событий/ошибок, связанных с работой модели или состоянием участка.
    *   Возможность выгрузки исторических данных (прогнозы, исходные данные) за выбранный период.

## Что нужно сделать (Next Steps / To-Do)

1.  **Анализ данных:** Глубокое исследование данных телеметрии (`data.csv`) и лабораторных анализов (`Анализы.xlsx`), включая визуализацию, поиск аномалий, корреляций, определение режимов работы, анализ временных лагов.
2.  **Обработка данных:** Очистка данных (выбросы, пропуски), синхронизация данных разной частоты (телеметрия и лаборатория).
3.  **Инжиниринг признаков:** Создание новых признаков на основе данных телеметрии, возможно, с учетом лабораторных данных и физики процесса. Особое внимание уделить признакам, отражающим транспортные задержки.
4.  **Моделирование:**
    *   Разработка моделей (рассмотреть авторегрессионные подходы, модели с учетом временных лагов, ML/DL модели) для предсказания гранулометрии **на основе данных телеметрии и калибровки по лабораторным данным**.
    *   Особое внимание уделить моделированию и учету **транспортных задержек**.
    *   Обучение и валидация моделей (используя лабораторные данные как таргет для обучения/калибровки, гранулометры - для доп. оценки).
5.  **Разработка интерфейса:** Создание дашборда согласно плану (опционально, в зависимости от приоритетов).
6.  **Подготовка отчета и дорожной карты:** Документирование исследования, модели и плана внедрения.
7.  **Тестирование:** Оценка модели на отложенной (тестовой) выборке, если будет предоставлена.
